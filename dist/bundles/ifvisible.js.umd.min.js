!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("ifvisible.js",["exports"],e):e((t.ifvisible=t.ifvisible||{},t.ifvisible.js={}))}(this,function(o){"use strict";function s(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var s,n,o=i.call(t),r=[];try{for(;(void 0===e||0<e--)&&!(s=o.next()).done;)r.push(s.value)}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=o["return"])&&i.call(o)}finally{if(n)throw n.error}}return r}var r,t,n,u,a="active",d="idle",i="hidden",h=void 0;t=o.Events||(o.Events={}),u={},t.attach=function e(t,e){u[t]||(u[t]=[]),u[t].push(e)},t.fire=function f(t,i){u[t]&&u[t].forEach(function(t){t.apply(void 0,function e(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(i))})},t.remove=function c(t,e){u[t]&&(u[t]=u[t].filter(function(t){return e!==t}))},t.dom=function l(t,e,i){return n||(n=t.addEventListener?function(t,e,i){return t.addEventListener(e,i,!1)}:"function"==typeof t.attachEvent?function(t,e,i){return t.attachEvent("on"+e,i,!1)}:function(t,e,i){return t["on"+e]=i}),n(t,e,i)};var v=function(){function t(t,e,i){var s=this;this.ifvisible=t,this.seconds=e,this.callback=i,this.stopped=!1,this.start(),this.ifvisible.on("statusChanged",function(t){!1===s.stopped&&(t.status===a?s.start():s.pause())})}return t.prototype.start=function(){this.stopped=!1,clearInterval(this.token),this.token=setInterval(this.callback,1e3*this.seconds)},t.prototype.stop=function(){this.stopped=!0,clearInterval(this.token)},t.prototype.resume=function(){this.start()},t.prototype.pause=function(){this.stop()},t}(),p=function(){for(var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",i[0];);return 4<t?t:void 0}(),m=function(){function t(t,e){var i=this;this.root=t,this.doc=e,this.status=a,this.VERSION="",this.idleTime=3e4;var s="blur";if(void 0!==this.doc.hidden?(r="hidden",h="visibilitychange"):void 0!==this.doc.mozHidden?(r="mozHidden",h="mozvisibilitychange"):void 0!==this.doc.msHidden?(r="msHidden",h="msvisibilitychange"):void 0!==this.doc.webkitHidden&&(r="webkitHidden",h="webkitvisibilitychange"),void 0===r)p<9&&(s="focusout"),o.Events.dom(this.root,s,function(){return i.blur()}),o.Events.dom(this.root,"focus",function(){return i.focus()});else{var n=function(){i.doc[r]?i.blur():i.focus()};n(),o.Events.dom(this.doc,h,n)}this.startIdleTimer(),this.trackIdleStatus()}return t.prototype.startIdleTimer=function(t){var e=this;t instanceof MouseEvent&&0===t.movementX&&0===t.movementY||(clearTimeout(this.timer),this.status===d&&this.wakeup(),this.idleStartedTime=+new Date,this.timer=setTimeout(function(){if(e.status===a||e.status===i)return e.idle()},this.idleTime))},t.prototype.trackIdleStatus=function(){o.Events.dom(this.doc,"mousemove",this.startIdleTimer.bind(this)),o.Events.dom(this.doc,"mousedown",this.startIdleTimer.bind(this)),o.Events.dom(this.doc,"keyup",this.startIdleTimer.bind(this)),o.Events.dom(this.doc,"touchstart",this.startIdleTimer.bind(this)),o.Events.dom(this.root,"scroll",this.startIdleTimer.bind(this))},t.prototype.on=function(t,e){return o.Events.attach(t,e),this},t.prototype.off=function(t,e){return o.Events.remove(t,e),this},t.prototype.setIdleDuration=function(t){return this.idleTime=1e3*t,this.startIdleTimer(),this},t.prototype.getIdleDuration=function(){return this.idleTime},t.prototype.getIdleInfo=function(){var t,e=+new Date;if(this.status===d)t={isIdle:!0,idleFor:e-this.idleStartedTime,timeLeft:0,timeLeftPer:100};else{var i=this.idleStartedTime+this.idleTime-e;t={isIdle:!1,idleFor:e-this.idleStartedTime,timeLeft:i,timeLeftPer:parseFloat((100-100*i/this.idleTime).toFixed(2))}}return t},t.prototype.idle=function(t){return t?this.on("idle",t):(this.status=d,o.Events.fire("idle"),o.Events.fire("statusChanged",[{status:this.status}])),this},t.prototype.blur=function(t){return t?this.on("blur",t):(this.status=i,o.Events.fire("blur"),o.Events.fire("statusChanged",[{status:this.status}])),this},t.prototype.focus=function(t){return t?this.on("focus",t):this.status!==a&&(this.status=a,o.Events.fire("focus"),o.Events.fire("wakeup"),o.Events.fire("statusChanged",[{status:this.status}])),this},t.prototype.wakeup=function(t){return t?this.on("wakeup",t):this.status!==a&&(this.status=a,o.Events.fire("wakeup"),o.Events.fire("statusChanged",[{status:this.status}])),this},t.prototype.onEvery=function(t,e){return new v(this,t,e)},t.prototype.now=function(t){return void 0!==t?this.status===t:this.status===a},t}(),b=new m("object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,document);o.ifvisible=b,o.Timer=v,o.IE=p,o.IfVisible=m,Object.defineProperty(o,"__esModule",{value:!0})});
//# sourceMappingURL=ifvisible.js.umd.min.js.map